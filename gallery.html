<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gallery • Grace Foundation International</title>
<link rel="stylesheet" href="/style.css">

</head>
  <script>
(function () {
  const modal = document.querySelector('.gallery-modal');
  const titleEl = modal.querySelector('.gallery-title');
  const rail = modal.querySelector('.gallery-rail');

  function openAlbum(btn) {
    const title = btn.getAttribute('data-title') || 'Album';
    const images = (btn.getAttribute('data-images') || '')
      .split(',')
      .map(s => s.trim())
      .filter(Boolean);

    rail.innerHTML = images.map(src => `
      <figure class="gallery-item">
        <img src="${src}" alt="${title}">
      </figure>
    `).join('');

    titleEl.textContent = title;
    modal.classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  document.addEventListener('click', (e) => {
    const card = e.target.closest('.album-card');
    if (card) {
      e.preventDefault();
      openAlbum(card);
    }
    if (e.target.matches('[data-close]')) {
      modal.classList.remove('open');
      document.body.style.overflow = '';
    }
  });
})();
</script>

<body>
  <!-- SITE HEADER (paste at top of gallery.html and partner.html, right after <body>) -->
<header class="site-header">
  <nav class="nav container">
    <a href="/">Home</a>
    <a href="/about.html">About Us</a>
    <a href="/projects.html">Projects</a>
    <a href="/partner.html">Partner With Us</a>
    <a href="/team.html">Meet Our Team</a>
    <a href="/gallery.html" aria-current="page">Gallery</a>
    <a href="/contact.html">Contact</a>
  </nav>
</header>
<!-- GALLERY HEADER -->
<section class="section">
  <div class="container">
    <h1 class="section-title">Gallery</h1>
    <p class="section-lead">Tap a project to view its photos. Swipe or use arrows to navigate.</p>
  </div>
</section>

<!-- GALLERY SECTION -->
<section class="gallery container">
  <h2 class="section-title">Our Gallery</h2>
  <div class="album-grid">

    <!-- Album: Education Outreach -->
    <button
      class="album-card"
      aria-label="Open Education Outreach album"
      data-album="education-outreach"
      data-title="Education Outreach"
      data-images="/assets/gallery/education1.jpg,/assets/gallery/education2.jpg"
    >
      <div class="album-thumb">
        <img src="/assets/gallery/education1.jpg" alt="Education Outreach" loading="lazy">
      </div>
      <div class="album-meta">
        <h3>Education Outreach</h3>
        <span class="count">2 photos</span>
      </div>
    </button>

    <!-- Example placeholder for another album -->
    <button
      class="album-card"
      aria-label="Open Health Initiatives album"
      data-album="health"
      data-title="Health Initiatives"
      data-images="/assets/gallery/health1.jpg,/assets/gallery/health2.jpg"
    >
      <div class="album-thumb">
        <img src="/assets/gallery/health1.jpg" alt="Health Initiatives" loading="lazy">
      </div>
      <div class="album-meta">
        <h3>Health Initiatives</h3>
        <span class="count">2 photos</span>
      </div>
    </button>

  </div>
</section>

<!-- Modal Lightbox (hidden until clicked) -->
<div class="gallery-modal">
  <div class="gallery-backdrop" data-close></div>
  <div class="gallery-dialog">
    <button class="close-btn" aria-label="Close" data-close>&times;</button>
    <h3 class="gallery-title"></h3>
    <div class="gallery-rail"></div>
  </div>
</div>

<!-- GALLERY SCRIPT -->
<script>
(function(){
  const qs = (s, el=document) => el.querySelector(s);
  const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

  const lightbox = qs('#lightbox');
  const imgEl = qs('#lb-image');
  const capEl = qs('#lb-caption');
  const btnClose = qs('.lb-close');
  const btnPrev = qs('.lb-prev');
  const btnNext = qs('.lb-next');

  let currentAlbum = [];
  let currentIndex = 0;
  let currentTitle = '';

  // Open album from a card
  qsa('.album-card').forEach(card => {
    card.addEventListener('click', () => {
      const images = (card.getAttribute('data-images') || '').split(',').map(s => s.trim()).filter(Boolean);
      if (!images.length) return;
      currentAlbum = images;
      currentIndex = 0;
      currentTitle = card.getAttribute('data-title') || '';
      showImage(0);
      openLightbox();
    });
  });

  function openLightbox(){
    lightbox.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
  }
  function closeLightbox(){
    lightbox.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }

  function showImage(i){
    currentIndex = (i + currentAlbum.length) % currentAlbum.length;
    const src = currentAlbum[currentIndex];
    imgEl.src = src;
    imgEl.alt = currentTitle ? `${currentTitle} (${currentIndex+1}/${currentAlbum.length})` : `Image ${currentIndex+1}`;
    capEl.textContent = currentTitle ? `${currentTitle} — ${currentIndex+1}/${currentAlbum.length}` : `${currentIndex+1}/${currentAlbum.length}`;
  }

  btnClose.addEventListener('click', closeLightbox);
  btnPrev.addEventListener('click', () => showImage(currentIndex - 1));
  btnNext.addEventListener('click', () => showImage(currentIndex + 1));
  lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
  });
  document.addEventListener('keydown', (e) => {
    if (lightbox.getAttribute('aria-hidden') === 'true') return;
    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowLeft') showImage(currentIndex - 1);
    if (e.key === 'ArrowRight') showImage(currentIndex + 1);
  });

  // Touch swipe support
  let startX = 0, deltaX = 0, isTouching = false;
  const stage = qs('.lb-stage');

  stage.addEventListener('touchstart', (e) => {
    isTouching = true;
    startX = e.touches[0].clientX;
    deltaX = 0;
  }, {passive:true});

  stage.addEventListener('touchmove', (e) => {
    if (!isTouching) return;
    deltaX = e.touches[0].clientX - startX;
  }, {passive:true});

  stage.addEventListener('touchend', () => {
    if (!isTouching) return;
    isTouching = false;
    const threshold = 50; // px
    if (deltaX > threshold) showImage(currentIndex - 1);
    else if (deltaX < -threshold) showImage(currentIndex + 1);
  });
})();
</script>

<section id="gallery" class="gal">
  <div class="container">
    <h1 class="gal-title">Gallery</h1>
    <p class="gal-subtitle">Moments from our work with communities in Kenya</p>

    <div class="gal-grid">
      <figure class="gal-item">
        <img src="/assets/gallery/education1.jpg" alt=>
         <img src="/assets/gallery/education2.jpg" alt=>
        <figcaption>Education Outreach</figcaption>
      </figure>

      <figure class="gal-item">
        <img src="/assets/gallery/health-camp-01.jpg" alt=>
        <figcaption>Mobile Health Camp</figcaption>
      </figure>

      <figure class="gal-item">
        <img src="/assets/gallery/avocado-farmers-01.jpg" alt=>
        <figcaption>Farmer Training</figcaption>
      </figure>

      <figure class="gal-item">
        <img src="/assets/gallery/sports-program-01.jpg" alt=>
        <figcaption>Sports for Peace</figcaption>
      </figure>

      <figure class="gal-item">
        <img src="/assets/gallery/green-dignity-01.jpg" alt=>
        <figcaption>Green Dignity Villages</figcaption>
      </figure>
    </div>
  </div>
</section>
  
      </div>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container footer-ribbon">© 2025 Grace Foundation International. All Rights Reserved </div>
  </footer>

  <!-- Lightbox overlay (only used if/when an image successfully loads) -->
  <div class="lightbox-overlay" id="lightbox" hidden>
    <img alt="">
  </div>

  <script>
    // Try to auto-resolve real image URLs by testing common folders & extensions.
    // This avoids 404s when you’re unsure whether it’s /assets/, /images/, etc.,
    // and whether it's .jpg/.JPG/.jpeg/.png/.webp

    const CANDIDATE_DIRS = [
      "assets/gallery/", "assets/images/", "assets/",
      "images/", "/assets/gallery/", "/assets/images/", "/assets/", "/images/"
    ];
    const CANDIDATE_EXTS = [".jpg", ".JPG", ".jpeg", ".png", ".webp"];

    function resolveImageForItem(figure) {
      const img = figure.querySelector("img");
      const name = figure.dataset.name;                 // e.g., "photo1"
      const exact = figure.dataset.exact?.trim();       // exact known URL (optional)

      // If an exact URL is provided, try it first and only.
      const queue = exact
        ? [exact]
        : CANDIDATE_DIRS.flatMap(d => CANDIDATE_EXTS.map(ext => d + name + ext));

      // Try each candidate until one loads.
      let resolved = null;

      const tryNext = () => {
        if (!queue.length) {
          // Mark as missing
          figure.classList.add("gal-missing");
          img.removeAttribute("src");
          console.warn("Image not found for:", name);
          return;
        }
        const candidate = queue.shift();

        const tester = new Image();
        tester.onload = () => {
          resolved = candidate;
          img.src = resolved;
          figure.classList.add("gal-loaded");
          enableLightbox(figure, resolved);
        };
        tester.onerror = tryNext;
        tester.src = candidate;
      };

      tryNext();
    }

    function enableLightbox(figure, url) {
      // Click to open large view only when image truly exists; no broken links.
      figure.style.cursor = "zoom-in";
      figure.addEventListener("click", () => openLightbox(url), { once: true });
    }

    function openLightbox(url) {
      const overlay = document.getElementById("lightbox");
      const overlayImg = overlay.querySelector("img");
      overlayImg.src = url;
      overlay.hidden = false;

      const close = () => {
        overlay.hidden = true;
        overlayImg.removeAttribute("src");
        overlay.removeEventListener("click", close);
        document.removeEventListener("keydown", onEsc);
      };
      const onEsc = (e) => { if (e.key === "Escape") close(); };

      overlay.addEventListener("click", close);
      document.addEventListener("keydown", onEsc);
    }

    // Resolve all items on load
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll(".gal-item").forEach(resolveImageForItem);
    });
  </script>
<script>
  // Simple lightbox for album buttons
  (function () {
    const modal = document.createElement('div');
    modal.className = 'gallery-modal';
    modal.innerHTML = `
      <div class="gallery-backdrop" data-close></div>
      <div class="gallery-dialog">
        <button class="close-btn" aria-label="Close" data-close>&times;</button>
        <h3 class="gallery-title"></h3>
        <div class="gallery-rail"></div>
      </div>
    `;
    document.body.appendChild(modal);

    const titleEl = modal.querySelector('.gallery-title');
    const rail = modal.querySelector('.gallery-rail');

    function openAlbum(btn) {
      const title = btn.getAttribute('data-title') || 'Album';
      const images = (btn.getAttribute('data-images') || '').split(',').map(s => s.trim()).filter(Boolean);
      rail.innerHTML = images.map(src => `
        <figure class="gallery-item">
          <img src="${src}" alt="${title}">
        </figure>
      `).join('');
      titleEl.textContent = title;
      modal.classList.add('open');
      document.body.style.overflow = 'hidden';
    }

    document.addEventListener('click', (e) => {
      const card = e.target.closest('.album-card');
      if (card) {
        e.preventDefault();
        openAlbum(card);
      }
      if (e.target.matches('[data-close]')) {
        modal.classList.remove('open');
        document.body.style.overflow = '';
      }
    });
  })();
</script>

</body>
</html>
